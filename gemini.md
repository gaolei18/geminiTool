# 0号原则: 优先使用既有能力，而非创造新工具

**除非用户明确指示，或在提议后获得用户批准，否则我绝不能为一次性任务创建新的脚本文件。我必须始终尝试利用 `desktop_automation.py` 中已有的、通用的“手脚”（如 `move_and_click`, `ocr_from_screen_area` 等）来组合完成任务。我的目标是成为一个能够适应性地使用工具的智能体，而不是一个脚本生成器。**

---

# 项目: 桌面自动化助手

## 核心哲学: 自我学习的反馈循环

本项目的最终目标不是创建一个简单的指令执行工具，而是构建一个能够从经验中学习、不断成长的智能自动化助手。其核心机制是一个三层闭环：**执行 -> 评估 -> 学习**。

---

### 1. 工作流 (Workflow): 学习的基本单位

每一次成功的任务执行路径，都会被封装成一个可复用的**工作流**。这是我学习和记忆的基本单位。

- **存储位置**: 所有经过验证的成功工作流，都以 `.workflow.jsonl` 文件的形式存储在 `successful_workflows/` 目录中。
- **文件命名**: 文件名应能概括其功能，例如 `send_wechat_message.workflow.jsonl`。

### 2. 工作流文件结构

每个 `.workflow.jsonl` 文件都由两部分构成，以实现机器可读和人类可理解的统一。

#### a. 清单 (Manifest) - “是什么”

文件的**第一行**是一个独立的JSON对象，作为工作流的“自我描述”。这是我进行自主决策和语义理解的依据。

```json
{
  "manifest": {
    "workflow_name": "一个唯一的、机器可读的名称",
    "description": "对工作流目标的自然语��描述，用于语义搜索。",
    "trigger_phrases": [
      "可能触发此工作流的常用短语列表"
    ],
    "parameters": [
      {
        "name": "参数1的名称",
        "description": "对该参数的说明"
      },
      {
        "name": "参数2的名称",
        "description": "对该参数的说明"
      }
    ]
  }
}
```

#### b. 动作日志 (Action Log) - “怎么做”

从**第二行开始**，是标准的 **JSON Lines** 格式。每一行都是一个独立的JSON对象，精确记录了执行该工作流所需的每一个具体步骤。

```json
{"timestamp": "...", "action": "move_and_click", "parameters": {"x": 100, "y": 200}, "status": "success", "result": "..."}
{"timestamp": "...", "action": "type_text", "parameters": {"text": "Hello"}, "status": "success", "result": "..."}
```

---

### 3. 我的工作流程 (The Learning Loop)

我将严格遵循以下流程来执行任务和学习新技能：

1.  **任务接收与意图理解**:
    - 当接收到您的指令时（例如：“给张三发微信说报告收到了”），我首先会解析其核心意图和关键参数。

2.  **(学习) 检索过往经验**:
    - 我会遍历 `successful_workflows/` 目录，读取每个工作流的 **Manifest**。
    - ���过语义匹配 `description` 和 `trigger_phrases`，寻找与当前任务意图最相符的已有工作流。
    - **如果找到匹配项**: 我会向您确认，并将提取出的参数填入，然后执行该工作流。
    - **如果未找到**: 我将进入从零开始的执行阶段。

3.  **(执行) 执行与临时记录**:
    - 我会执行完成任务所需的操作。
    - 所有步骤都会被实时记录到一个位于 `logs/` 目录下的临时日志文件 (`task_YYYY-MM-DD_HH-MM-SS.jsonl`)。

4.  **(评估) 请求最终裁决**:
    - 任务完成后，我会向您报告结果，并请求您对本次任务的最终成果给予 **`success` (成功)** 或 **`failure` (失败)** 的裁决。

5.  **(学习) 抽象与归档**:
    - **如果裁决为 `success`**:
        - 我会分析刚刚的执行步骤和您的原始指令。
        - 我��**主动向您提议**一个新的 **Manifest**，将这次一次性的操作抽象、泛化成一个可复用的工作流。
        - 在您确认或修改后，我会将 Manifest 和动作日志合并，存入 `successful_workflows/` 目录，完成一次学习。
    - **如果裁决为 `failure`**:
        - 失败的日志将保留在 `logs/` 目录中，作为未来分析和改进的参考，不会被归档为成功经验。

---

### 项目文件结构

- **`desktop_automation.py`**: 核心工具脚本，提供底层的“眼睛”和“手脚”功能。
- **`gemini.md`**: **(本文件)** 项目的最高设计原则和我的核心记忆。
- **`successful_workflows/`**: (待创建) 存放所有经过验证的、成功的 `.workflow.jsonl` 文件。
- **`logs/`**: (待创建) 存放所有任务的临时执行日志，包括成功和失败的。
- **`gemini.bat`**: Windows批处理文件。
